
USBTime=1e3; %factor
Pause_Time=1e-6; % seconds
s1.BaudRate = 115200*USBTime;


Move_X=100 % micron



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%                                   %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%            X COORDINATE           %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%                                   %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%addr='11831334'
Address_X='11831218';

%addr='11831334'
%w='E8030000' % 1000 decimal
%w='0000000F' % 15 in decimal
%w='00000014' % 20 in decimal

Write_X=num2str(dec2hex(Move_X,8))
%addr=26666

cmdstr_X=strcat('A2',Address_X,Write_X,'55')% -- reorder the bytes -- 
cmdstr_X = cmdstr_X([1 2 9 10 7 8 5 6 3 4 17 18 15 16 13 14 11 12 19 20]);
L_X = length(cmdstr_X);
c_X = hex2dec(reshape(cmdstr_X,2,L_X/2)');
fwrite(s1,c_X);    
pause(Pause_Time);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%                                   %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%            Y COORDINATE           %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%                                   %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%addr='11831334'
Address_Y='11832218';

%addr='11831334'
%w='E8030000' % 1000 decimal
%w='0000000F' % 15 in decimal
%w='00000014' % 20 in decimal

Write_Y=num2str(dec2hex(Move_Y,8))
%addr=26666

cmdstr_Y=strcat('A2',Address_Y,Write_Y,'55')% -- reorder the bytes -- 
cmdstr_Y = cmdstr_Y([1 2 9 10 7 8 5 6 3 4 17 18 15 16 13 14 11 12 19 20]);
L_Y = length(cmdstr_Y);
c_Y = hex2dec(reshape(cmdstr_Y,2,L_Y/2)');
fwrite(s1,c_Y);    
pause(Pause_Time);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%                                   %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%            Z COORDINATE           %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%                                   %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%addr='11831334'
Address_Z='11833218';

%addr='11831334'
%w='E8030000' % 1000 decimal
%w='0000000F' % 15 in decimal
%w='00000014' % 20 in decimal

Write_Z=num2str(dec2hex(Move_Z,8))
%addr=26666

cmdstr_Z=strcat('A2',Address_Z,Write_Z,'55')% -- reorder the bytes -- 
cmdstr_Z = cmdstr_Z([1 2 9 10 7 8 5 6 3 4 17 18 15 16 13 14 11 12 19 20]);
L_Z = length(cmdstr_Z);
c_Z = hex2dec(reshape(cmdstr_Z,2,L_Z/2)');
fwrite(s1,c_Z);    
pause(Pause_Time);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
